<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/pokerl/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=pokerl/livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Metrics
  #

Without metrics, I would have no way of knowing how far the agents have progressed. Inspecting the game play of 288 agents is not just time consuming, it&rsquo;s expensive. Videos consume valuable CPU and disk space to render. However, generating a few metrics are way smaller and easier and can provide data in real time.
For metrics writing, I had two sinks: Weights and Biases and a live map visualization Peter Whidden stood up for this effort. Without them, I wouldn&rsquo;t be able to make any logical improvements, I&rsquo;d only be guessing.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/pokerl/docs/chapter-3/metrics/">
  <meta property="og:site_name" content="Pokémon RL">
  <meta property="og:title" content="Metrics and Visualization">
  <meta property="og:description" content="Metrics # Without metrics, I would have no way of knowing how far the agents have progressed. Inspecting the game play of 288 agents is not just time consuming, it’s expensive. Videos consume valuable CPU and disk space to render. However, generating a few metrics are way smaller and easier and can provide data in real time.
For metrics writing, I had two sinks: Weights and Biases and a live map visualization Peter Whidden stood up for this effort. Without them, I wouldn’t be able to make any logical improvements, I’d only be guessing.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Metrics and Visualization | Pokémon RL</title>
<link rel="icon" href="/pokerl/favicon.png" >
<link rel="manifest" href="/pokerl/manifest.json">
<link rel="canonical" href="http://localhost:1313/pokerl/docs/chapter-3/metrics/">
<link rel="stylesheet" href="/pokerl/book.min.20566c4d69204c7b44949aa70a954a16ae963f6de14a8871d403b3c690ffd867.css" integrity="sha256-IFZsTWkgTHtElJqnCpVKFq6WP23hSohx1AOzxpD/2Gc=" crossorigin="anonymous">
  <script defer src="/pokerl/fuse.min.js"></script>
  <script defer src="/pokerl/en.search.min.609089bdf0d2128ecc6610d73567268095da34d009e846197f9b37980606a962.js" integrity="sha256-YJCJvfDSEo7MZhDXNWcmgJXaNNAJ6EYZf5s3mAYGqWI=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/pokerl/"><span>Pokémon RL</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <span>Chapter 1: RL and the Pokémon Environment</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/the-loop/" class="">RL Quickstart</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/env-setup/" class="">Setting up the Environment</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Breaking Down Pokémon</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/intro/" class="">Intro</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/battling/" class="">Battling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/8badges/" class="">The 8 Badges</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/field_interactions/" class="">Field Interactions and Exploration</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/team_rocket/" class="">Team Rocket</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/route/" class="">The &#34;Route&#34;</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-1/breakdown/risk_management/" class="">Risk Management</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Chapter 2: Observations, Rewards, and Policy</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-2/observations/" class="">Observations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-2/rewards/" class="">Rewards</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-2/policy/" class="">Policy</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Chapter 3: Building and Running the System</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-3/running/running/" class="">Running</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-3/reading-asm/" class="">Reading RAM</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-3/metrics/" class="active">Metrics and Visualization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-3/swarm/" class="">The Swarm</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Chapter 4: Concluding Thoughts</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-4/results/" class="">Results</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/pokerl/docs/chapter-4/future/" class="">Future</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/pokerl/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Metrics and Visualization</h3>

  <label for="toc-control">
    
    <img src="/pokerl/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#the-live-map">The Live Map</a></li>
    <li><a href="#weights-and-biases">Weights and Biases</a>
      <ul>
        <li><a href="#charts">Charts</a></li>
        <li><a href="#the-map-overlay">The Map Overlay</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="metrics">
  Metrics
  <a class="anchor" href="#metrics">#</a>
</h1>
<p>Without metrics, I would have no way of knowing how far the agents have progressed. Inspecting the game play of 288 agents is not just time consuming, it&rsquo;s expensive. Videos consume valuable CPU and disk space to render. However, generating a few metrics are way smaller and easier and can provide data in <em>real time</em>.</p>
<p>For metrics writing, I had two sinks: <a href="https://wandb.ai/">Weights and Biases</a> and <a href="https://pwhiddy.github.io/pokerl-map-viz/">a live map visualization</a> Peter Whidden stood up for this effort. Without them, I wouldn&rsquo;t be able to make any logical improvements, I&rsquo;d only be guessing.</p>
<h2 id="the-live-map">
  The Live Map
  <a class="anchor" href="#the-live-map">#</a>
</h2>
<div style="text-align: center;">
<p><img src="assets/livemap.png" alt="" /></p>
</div>
<p>The live map is a really simple addition from the developer side. In a wrapper per agent, I open a websocket to a service Peter is hosting and I send the agent&rsquo;s coordinates over the websocket. I can leave it open during the day. I can check it out whenever. It also provided me a valuable way of seeing if new code I wrote (particularly sarming) was properly working. It was the first place I looked when evaluating a running experiment.</p>
<h2 id="weights-and-biases">
  Weights and Biases
  <a class="anchor" href="#weights-and-biases">#</a>
</h2>
<h3 id="charts">
  Charts
  <a class="anchor" href="#charts">#</a>
</h3>
<p>Charts provided an invaluable way for me to understand the timeline of progress and understand how fast the agent was capable of achieving tasks.</p>
<p>For example, I could look at a badge count metric to see how long it would take on average for an agent to get a badge. Fun fact, my current record for badge 1 is <em>10 minutes</em></p>
<div style="text-align: center;">
<p><img src="assets/badges.png" alt="" /></p>
</div>
<p>Or I could see how many events the agent has finished.</p>
<div style="text-align: center;">
<p><img src="assets/events.png" alt="" /></p>
</div>
<p>I could see if my pokecenter healing reward was finally tuned correctly.</p>
<div style="text-align: center;">
<p><img src="assets/pokecenter.png" alt="" /></p>
</div>
<p>And finally, I kept track of the current party all agents had. The party table provided me information I would only otherwise have by measuring gift Pokémon event completion. It also sometimes showed some fun scenarios.</p>
<div style="text-align: center;">
<p><img src="assets/partytable.png" alt="" /></p>
</div>
<p>For context, to get a Mr. Mime, the player must catch an Abra (extremely difficult to catch) and then perform an in-game train.</p>
<h3 id="the-map-overlay">
  The Map Overlay
  <a class="anchor" href="#the-map-overlay">#</a>
</h3>
<div style="text-align: center;">
<p><img src="assets/heatmap.png" alt="" /></p>
</div>
<p>Joseph Suarez at PufferAI also wrote a nifty heatmap of where the agent has visited during the experiment. I&rsquo;ve made modifications since to show where the agent has visited during the episode. The map provided me a way of seeing where the agents were focusing effort when the live map was too hard to follow.</p>
<p>The heatmap showed some interesting behavior from the agents. For example, it clued me into how the agents would not focus on maximizing exploration in the Safari Zone, the agents&rsquo; exploiting the hidden object reward (mostly through gambling), and the agents&rsquo; preference to avoid battles (as a way to not lose exploration reward possibilities for a mini-episode).</p>
<div style="text-align: center;">
<p><img src="assets/safari.png" alt="" /></p>
</div>
<p>Sometimes the heatmap would also clue me into &ldquo;routes&rdquo; the agents&rsquo; policy would collapse to. For example when I mis-weighted tree cutting rewards, the heatmap pointed out that the agents&rsquo; would optimize for a route that would maximize their ability to cut trees in an episode.</p>
<div style="text-align: center;">
<p><img src="assets/maxcut.png" alt="" /></p>
</div>
<p>The map could also show me more intelligent routing from the agents like when they found the optimal path through Rock Tunnel (wild battles were disabled for this run).</p>
<div style="text-align: center;">
<p><img src="assets/rocktunnel.png" alt="" /></p>
</div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#the-live-map">The Live Map</a></li>
    <li><a href="#weights-and-biases">Weights and Biases</a>
      <ul>
        <li><a href="#charts">Charts</a></li>
        <li><a href="#the-map-overlay">The Map Overlay</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












